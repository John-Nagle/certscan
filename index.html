<!DOCTYPE html>
<html><head>


  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Certscan : SSL/TLS certificate analyzer for U. Michigan certificate scans">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css"><title>Certscan</title></head><body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/John-Nagle/certscan">View on GitHub</a>

          </header><h1 id="project_title">Certscan</h1>
          <h2 id="project_tagline">SSL/TLS certificate analyzer for U. Michigan certificate scans</h2>

            <section style="top: 337px; left: 1303px;" id="downloads">
              <a class="zip_download_link" href="https://github.com/John-Nagle/certscan/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/John-Nagle/certscan/tarball/master">Download this project as a tar.gz file</a></section><!-- MAIN CONTENT --></div>
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        </section>This is the software behind the paper


	
	
	
	<style type="text/css">
	<!--
		@page { margin: 0.79in }
		H1 { margin-bottom: 0.08in }
		H1.western { font-family: "Liberation Sans", sans-serif; font-size: 16pt }
		H1.cjk { font-family: "Droid Sans Fallback"; font-size: 16pt }
		H1.ctl { font-family: "Lohit Hindi"; font-size: 16pt }
		P { margin-bottom: 0.08in }
		A:link { so-language: zxx }
	-->
	</style>

<h1 class="western" align="center"><a href="whoamitalkingto04.pdf">Who am I Talking To?<br>
Ambiguities
in secure certificates for web commerce</a></h1>
<br>
We are interested in SSL certificates where the certificate does not
properly reflect the actual owner of the domain.&nbsp; So we developed
this tool to analyze SSL certificates in bulk. We are looking for
intermediary services which sit between the actual site of interest and
the user, acting as a man-in-the-middle. <br>
<br>
The SSL certificates of almost all sites on the Web are available for
analysis. The security group at the University of Michigan periodically
examines every IPv4 address on the Internet to see if it will return an
SSL/TLS certificate. The results of these scans are available as large
(about 35GB) CSV text files at <a href="https://scans_io/study/umich-https" target="_blank">https://scans_io/study/umich-https</a>.
Certscan is a utility program to work with these files. Generally it's
used to select entries from those files based on some criterion, and
loads a database with the certificates of interest for further queries.<br>
<br>
Certificates with multiple, urelated alternate domains warrant further
examination.&nbsp; So the default for this program is to find
certificates with more than one second-level domain, and only load
those. <br>
<br>
<h3>Program prerequisites:</h3>
<ul>
  <li>&nbsp;Linux recommended, Windows will probably work.</li>
  <li>&nbsp;Go 1.3 installed.</li>
  <li>MySQL or equivalent installed.</li>
  <li>Go/MySQL connector installed. (<a href="https://github.com/go-sql-driver/mysql/">https://github.com/go-sql-driver/mysql/</a>)</li>
  <li>About 100GB of free disk space (for data)<br>
  </li>
</ul>
Further details are in the README.txt file in the <a href="https://github.com/John-Nagle/certscan">source distribution on GitHub.</a>
The program must be built from source, using the command "go build
certscan". Knowlege of the Go language is not required. Knowlege of SQL
is required to get useful results from the database.<br>
<br>
<h3>Using the database<br>
</h3>
Once certscan has been used to build a MySQL database of interesting certificates, the database can be queried.<br>
<br>
<span style="font-family: monospace;">S<span style="font-weight: bold;">ELECT * from certs WHERE Subject_commonname_2ld = "archive.org";</span></span><br style="font-family: Courier New,Courier,monospace; font-weight: bold;">
<br>
will display all certificates associated with "archive.org".<br>
<br>
<span style="font-family: monospace; font-weight: bold;">SELECT
Subject_commonname_2ld, Subject_organization, certs.Issuer_name,
capolicies.certlevel, count(DISTINCT Domain_2ld) AS count&nbsp; </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">FROM certs, domains, policies, capolicies&nbsp; </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">WHERE certs.Certificate_id = domains.Certificate_id&nbsp; </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">AND policies.Certificate_id = certs.Certificate_id AND policies.OID = capolicies.OID </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">AND Is_valid = TRUE AND Is_browser_valid = TRUE&nbsp; </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">AND capolicies.certlevel = "EV" </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">GROUP BY Subject_commonname_2ld,&nbsp; Subject_organization, certs.Issuer_name, capolicies.certlevel </span><br style="font-family: monospace; font-weight: bold;">
<span style="font-family: monospace; font-weight: bold;">ORDER BY count DESC LIMIT 100;</span><br style="font-family: monospace;">
<br>
will provide a list of the top 100 Extended Validation certificates with the most associated domain names.<br>
<br>
Exploring the certificates associated with a given site is quick.
Complex queries such as the above are rather slow because of all the
joins.&nbsp; Worst case is about an hour. <br>
<br>
Enjoy exploring the world of SSL certificates.<br>
<br>
</div><br>


    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        </footer><p class="copyright">Certscan maintained by <a href="https://github.com/John-Nagle">John-Nagle</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      
    </div>

    

  </body></html>